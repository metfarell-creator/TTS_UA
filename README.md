# StyleTTS 2 Ukrainian EXP

Оновлені інструкції для запуску українського експериментального стенда на базі StyleTTS 2.

## Ключові можливості
- **Gradio UI** з окремими вкладками для **Multi speaker** і **Single speaker**.
- Автоматична або ручна вербалізація тексту (додавання наголосів, заміна чисел тощо).
- Вибір голосу для багатоголосого режиму, контроль швидкості мовлення.
- Підтримка символу `+` для ручного виставлення наголосу.

## Швидкий старт
1. Підготуйте файлову структуру:
   ```
   D:/STYLETTS2-UKRAINIANEXP/
   ├── run.bat
   ├── app.py
   ├── verbalizer.py
   ├── config.yml
   ├── requirements.txt
   ├── filatov.pt
   ├── voices/
   │   ├── Анастасія Павленко.pt
   │   ├── Артем Окороков.pt
   │   └── ...
   ├── models/
   │   ├── models--patriotyk--styletts2_ukrainian_multispeaker/
   │   ├── models--patriotyk--styletts2_ukrainian_single/
   │   └── models--skypro1111--mbart-large-50-verbalization/
   └── python-portable/
   ```
2. Переконайтеся, що всі моделі й стилі лежать у відповідних папках.
3. Запустіть `run.bat` (Windows) або `python app.py` у середовищі з потрібними залежностями.
4. Відкрийте адресу, вказану Gradio, у браузері та синтезуйте мовлення.

## Системні вимоги
- **Python 3.11** (перевірено на Windows із вбудованим `python-portable`).
- **PyTorch 2.x** з підтримкою CUDA (якщо використовуєте GPU).
- Додаткові бібліотеки: `gradio`, `ukrainian-word-stress`, `ipa-uk`, `transformers`, `styletts2_inference` та інші із `requirements.txt`.

## Особливості реалізації
- Вербалізатор працює повністю офлайн та автоматично підбирає токенайзер (спершу `AutoTokenizer`, потім fallback на `MBart50TokenizerFast`).
- Для кожного голосу використовується `.pt` файл зі стилем; при відсутності вибраного голосу в multi-режимі береться перший доступний.
- Аудіофрагменти об'єднуються через `torch.cat`, а після синтезу повертається сигнал з частотою 24 кГц.
- Усі обчислення виконуються в режимі `torch.inference_mode()`.

## Налагодження
- Якщо бачите попередження про токенайзер — переконайтеся, що всі файли моделі в наявності; fallback покриває типові випадки офлайн-роботи.
- Для великих текстів застосовується розбиття на частини з урахуванням довжини та розділових знаків.
- Можна додавати власні стилі у папку `voices/`; файл має бути сумісним із моделлю (отриманим через StyleTTS 2).

## Запуск
- **Windows**: подвійний клік по `run.bat`.
- **Linux/macOS**: активуйте середовище та виконайте `python app.py`.
- Gradio автоматично відкриє API (`api_open=True`) і виведе посилання для браузера.
